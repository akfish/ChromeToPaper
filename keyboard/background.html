<html>
<head>
<title>Chromapaper Keyboard Shortcuts</title>
<script type="text/javascript" src="lib/jquery.js"></script>
<script type="text/javascript" src="lib/family.js"></script>
<script type="text/javascript">
//Migrate old options
if(localStorage.getItem('saveToInstapaper')!=null) {
  localStorage['opt_saveToInstapaper']=localStorage['saveToInstapaper'];
  localStorage.removeItem('saveToInstapaper');
}
if(localStorage.getItem('openInstapaperList')!=null) {
  localStorage['opt_openInstapaperList']=localStorage['openInstapaperList'];
  localStorage.removeItem('openInstapaperList');
}
refreshSettings();

//Handle Content Script
chrome.extension.onRequest.addListener(function(a,b,c) {
  c(refreshSettings());
});

//Function setDefault: Set localStorage key if not already set
function refreshSettings() {
  var a=['opt_saveToInstapaper','opt_openInstapaperList'];
  var s={ };
  s.d={ };
  s.id=instapaper_id;
  for(var i=0;i<a.length;i++) {
    if(localStorage.getItem(a[i])==null) {
      localStorage[a[i]]='Not binded';
    }
    else if(localStorage[a[i]]!='Not binded') {
      s.d[a[i]]=localStorage[a[i]];
    }
  }
  return s;
}
</script>
</head>
<body>
</body>
</html>